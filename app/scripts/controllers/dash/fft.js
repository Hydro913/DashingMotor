'use strict';

/**
 * @ngdoc function
 * @name dashingMotorApp.controller:DashFftCtrl
 * @description
 * # DashFftCtrl
 * Controller of the dashingMotorApp
 */
angular.module('dashingMotorApp')
  .controller('DashFftCtrl', ['$scope', '$log', function ($scope, $log) {
    $scope.awesomeThings = [
      'HTML5 Boilerplate',
      'AngularJS',
      'Karma'
    ];

    $scope.$log = $log;

    $scope.isActive = function (viewLocation) {
      this.$log.log('DashFftCtrl ' + $location.path());
      return viewLocation === $location.path();
    };

    $scope.options = {
      chart: {
        type: 'lineChart',
        height: 450,
        margin : {
          top: 20,
          right: 20,
          bottom: 40,
          left: 55
        },
        x: function(d){ return d.x; },
        y: function(d){ return d.y; },
        useInteractiveGuideline: true,
        dispatch: {
          stateChange: function(e){ console.log("stateChange"); },
          changeState: function(e){ console.log("changeState"); },
          tooltipShow: function(e){ console.log("tooltipShow"); },
          tooltipHide: function(e){ console.log("tooltipHide"); }
        },
        xAxis: {
          axisLabel: 'Time (ms)'
        },
        yAxis: {
          axisLabel: 'Voltage (v)',
          tickFormat: function(d){
            return d3.format('.02f')(d);
          },
          axisLabelDistance: 30
        },
        callback: function(chart){
          console.log("!!! lineChart callback !!!");
        }
      },
      title: {
        enable: true,
        text: 'Motor Current'
      },
      subtitle: {
        enable: true,
        text: 'Show is mains current with an ideal sin wave on top',
        css: {
          'text-align': 'center',
          'margin': '10px 13px 0px 7px'
        }
      },
      caption: {
        enable: true,
        html: '<b>Figure 1.</b> Motor Current',
        css: {
          'text-align': 'justify',
          'margin': '10px 13px 0px 7px'
        }
      }
    };

    $scope.data = sinAndCos();

    /*Random Data Generator */
    function sinAndCos() {
      var fft = [];


      //Data is represented as an array of {x,y} pairs.
      var samples_length =  247;

      var xData = [0,0.48906,0.97813,1.4672,1.9563,2.4453,2.9344,3.4234,3.9125,4.4016,4.8906,5.3797,5.8688,6.3578,6.8469,7.336,7.825,8.3141,8.8031,9.2922,9.7813,10.27,10.759,11.248,11.738,12.227,12.716,13.205,13.694,14.183,14.672,15.161,15.65,16.139,16.628,17.117,17.606,18.095,18.584,19.073,19.563,20.052,20.541,21.03,21.519,22.008,22.497,22.986,23.475,23.964,24.453,24.942,25.431,25.92,26.409,26.899,27.388,27.877,28.366,28.855,29.344,29.833,30.322,30.811,31.3,31.789,32.278,32.767,33.256,33.745,34.234,34.724,35.213,35.702,36.191,36.68,37.169,37.658,38.147,38.636,39.125,39.614,40.103,40.592,41.081,41.57,42.059,42.549,43.038,43.527,44.016,44.505,44.994,45.483,45.972,46.461,46.95,47.439,47.928,48.417,48.906,49.395,49.885,50.374,50.863,51.352,51.841,52.33,52.819,53.308,53.797,54.286,54.775,55.264,55.753,56.242,56.731,57.22,57.71,58.199,58.688,59.177,59.666,60.155,60.644,61.133,61.622,62.111,62.6,63.089,63.578,64.067,64.556,65.045,65.535,66.024,66.513,67.002,67.491,67.98,68.469,68.958,69.447,69.936,70.425,70.914,71.403,71.892,72.381,72.87,73.36,73.849,74.338,74.827,75.316,75.805,76.294,76.783,77.272,77.761,78.25,78.739,79.228,79.717,80.206,80.696,81.185,81.674,82.163,82.652,83.141,83.63,84.119,84.608,85.097,85.586,86.075,86.564,87.053,87.542,88.031,88.521,89.01,89.499,89.988,90.477,90.966,91.455,91.944,92.433,92.922,93.411,93.9,94.389,94.878,95.367,95.856,96.346,96.835,97.324,97.813,98.302,98.791,99.28,99.769,100.26,100.75,101.24,101.73,102.21,102.7,103.19,103.68,104.17,104.66,105.15,105.64,106.13,106.62,107.1,107.59,108.08,108.57,109.06,109.55,110.04,110.53,111.02,111.51,112,112.48,112.97,113.46,113.95,114.44,114.93,115.42,115.91,116.4,116.89,117.38,117.86,118.35,118.84,119.33,119.82,120.31];
      var yData = [-62.966,-46.548,-41.147,-40.672,-43.193,-53.567,-50.623,-42.028,-40.7,-41.462,-48.032,-62.255,-43.82,-40.398,-41.286,-44.158,-60.918,-46.866,-42.174,-40.289,-42.077,-49.633,-52.223,-43.142,-40.331,-40.768,-45.61,-62.563,-44.796,-40.659,-39.95,-42.29,-52.908,-49.339,-41.496,-39.307,-40.65,-47.064,-60.07,-43.059,-39.286,-39.2,-43.034,-56.293,-45.612,-39.63,-38.486,-40.089,-46.224,-49.916,-40.16,-37.425,-37.858,-41.99,-67.733,-40.629,-36.131,-34.994,-37.553,-47.999,-39.329,-32,-28.243,-25.169,-17.522,-36.55,-37.021,-42.272,-49.695,-49.003,-52.829,-56.627,-47.846,-44.068,-43.039,-46.546,-71.679,-45.14,-40.627,-40.537,-43.076,-54.796,-46.684,-40.358,-38.088,-40.291,-45.583,-50.058,-40.167,-37.347,-37.166,-41.887,-66.387,-41.42,-36.266,-35.265,-37.477,-47.445,-43.794,-35.815,-33.62,-34.293,-39.481,-51.049,-35.502,-31.932,-31.39,-34.417,-48.14,-36.25,-30.005,-28.053,-29.233,-35.996,-38.396,-27.322,-23.545,-22.702,-25.623,-63.255,-20.785,-12.341,-3.9756,0,-22.472,-23.81,-19.647,-20.094,-23.16,-30.574,-42.993,-29.835,-27.431,-28.266,-32.697,-48.931,-37.305,-32.181,-31.706,-34.26,-42.5,-45.55,-36.829,-34.538,-35.997,-40.499,-71.436,-41.094,-37.438,-37.056,-40.514,-52.671,-45.557,-41.24,-39.183,-41.465,-48.351,-59.242,-43.844,-41.653,-42.109,-47.02,-65.784,-48.246,-44.956,-44.651,-48.153,-65.851,-53.726,-48.901,-49.614,-50.198,-56.251,-53.977,-55.625,-53.42,-48.054,-43.928,-43.605,-58.083,-35.159,-19.707,-19.452,-31.189,-47.167,-40.786,-36.503,-36.496,-39.045,-47.928,-49.154,-41.985,-40.143,-41.466,-46.926,-64.832,-46.136,-42.397,-42.429,-45.87,-60.283,-51.456,-44.807,-42.815,-46.074,-53.924,-58.246,-47.338,-45.316,-45.118,-51.299,-70.782,-50.522,-46.362,-47.12,-49.366,-53.985,-57.75,-48.359,-46.568,-48.491,-52.391,-61.689,-52.844,-48.702,-47.278,-50.365,-61.03,-55.112,-48.164,-49.586,-50.219,-54.098,-62.786,-52.268,-48.531,-49.274,-53.417,-71.231,-55.467,-50.028,-49.066,-52.705,-59.011,-60.669,-52.658,-48.889];

      for (var i = 0; i < samples_length; i++) {
        var t = i/(samples_length*20);

        fft.push({x: xData[i], y: yData[i]});
      }


      //Line chart data should be sent as an array of series objects.
      return [
        {
          values: fft,      //values - represents the array of {x,y} data points
          key: 'Sine Wave', //key  - the name of the series.
          color: '#ff7f0e'  //color - optional: choose your own line color.
        }
      ];
    };
  }]);
